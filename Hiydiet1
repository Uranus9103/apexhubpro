local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- RemoteEvent cho TP v√† Ban
local tpEvent = Instance.new("RemoteEvent")
tpEvent.Name = "TPEvent"
tpEvent.Parent = ReplicatedStorage

local banEvent = Instance.new("RemoteEvent")
banEvent.Name = "BanEvent"
banEvent.Parent = ReplicatedStorage

-- X·ª≠ l√Ω d·ªãch chuy·ªÉn
tpEvent.OnServerEvent:Connect(function(player, target)
	if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
		if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			player.Character.HumanoidRootPart.CFrame =
				target.Character.HumanoidRootPart.CFrame + Vector3.new(3,0,0)
		end
	end
end)

-- X·ª≠ l√Ω ban (kick)
banEvent.OnServerEvent:Connect(function(player, target)
	if target and target:IsA("Player") then
		target:Kick("B·∫°n ƒë√£ b·ªã ban b·ªüi " .. player.Name)
	end
end)

-- Khi ng∆∞·ªùi ch∆°i join ‚Üí t·∫°o GUI cho h·ªç
Players.PlayerAdded:Connect(function(player)
	player.CharacterAdded:Wait() -- ƒë·ª£i nh√¢n v·∫≠t spawn

	local gui = Instance.new("ScreenGui")
	gui.Name = "AdminGui"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	-- Tab n√∫t
	local tpTab = Instance.new("TextButton")
	tpTab.Size = UDim2.new(0,120,0,40)
	tpTab.Position = UDim2.new(0.05,0,0.05,0)
	tpTab.Text = "TP List"
	tpTab.BackgroundColor3 = Color3.fromRGB(50,200,50)
	tpTab.TextColor3 = Color3.new(1,1,1)
	tpTab.Parent = gui

	local banTab = tpTab:Clone()
	banTab.Text = "BAN List"
	banTab.Position = UDim2.new(0.15,0,0.05,0)
	banTab.BackgroundColor3 = Color3.fromRGB(200,50,50)
	banTab.Parent = gui

	-- Frame danh s√°ch
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0,220,0,300)
	frame.Position = UDim2.new(0.05,0,0.12,0)
	frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
	frame.Parent = gui

	local scroll = Instance.new("ScrollingFrame")
	scroll.Size = UDim2.new(1,0,1,-40)
	scroll.Position = UDim2.new(0,0,0,0)
	scroll.ScrollBarThickness = 6
	scroll.CanvasSize = UDim2.new(0,0,0,0)
	scroll.BackgroundTransparency = 0
	scroll.Parent = frame

	-- N√∫t reload
	local reloadBtn = Instance.new("TextButton")
	reloadBtn.Size = UDim2.new(1,0,0,40)
	reloadBtn.Position = UDim2.new(0,0,1,-40)
	reloadBtn.Text = "üîÑ Reload"
	reloadBtn.BackgroundColor3 = Color3.fromRGB(100,100,200)
	reloadBtn.TextColor3 = Color3.new(1,1,1)
	reloadBtn.Parent = frame

	-- Tab hi·ªán t·∫°i
	local currentMode = "TP"

	tpTab.MouseButton1Click:Connect(function()
		currentMode = "TP"
		tpTab.BackgroundColor3 = Color3.fromRGB(50,200,50)
		banTab.BackgroundColor3 = Color3.fromRGB(200,50,50)
		reloadBtn.Text = "üîÑ Reload TP List"
	end)

	banTab.MouseButton1Click:Connect(function()
		currentMode = "BAN"
		banTab.BackgroundColor3 = Color3.fromRGB(50,200,50)
		tpTab.BackgroundColor3 = Color3.fromRGB(200,50,50)
		reloadBtn.Text = "üîÑ Reload BAN List"
	end)

	-- H√†m update list
	local function updateList()
		for _,child in pairs(scroll:GetChildren()) do
			if child:IsA("TextButton") then
				child:Destroy()
			end
		end

		local y = 0
		for _,plr in pairs(Players:GetPlayers()) do
			if plr ~= player then
				local btn = Instance.new("TextButton")
				btn.Size = UDim2.new(1,-10,0,40)
				btn.Position = UDim2.new(0,5,0,y)
				btn.Text = plr.Name
				btn.BackgroundColor3 = Color3.fromRGB(70,70,70)
				btn.TextColor3 = Color3.new(1,1,1)
				btn.Parent = scroll

				btn.MouseButton1Click:Connect(function()
					if currentMode == "TP" then
						tpEvent:FireServer(plr)
						ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("/tp_"..plr.Name, "All")
					elseif currentMode == "BAN" then
						banEvent:FireServer(plr)
						ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer("/ban_"..plr.Name, "All")
					end
				end)

				y = y + 45
			end
		end
		scroll.CanvasSize = UDim2.new(0,0,0,y)
	end

	reloadBtn.MouseButton1Click:Connect(updateList)
	Players.PlayerAdded:Connect(updateList)
	Players.PlayerRemoving:Connect(updateList)

	updateList()
end)
