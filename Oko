-- Key config
local KeyConfig = {
    Enable = true,
    Title = "Văn Thành IOS / Script Tổng Hợp",
    KeyLink = "https://your-key-link.com", -- Link lấy key
    Keys = {"VanThanhIOS"},
    Notifications = {
        Correct = "Đang Chạy Kịch Bản",
        Incorrect = "Mật Khẩu Không Đúng",
        CopyKeyLink = "Đã Sao Chép"
    }
}

-- Hàm tạo hiệu ứng đổi màu liên tục
local function RainbowEffect(uiElement)
    task.spawn(function()
        local hue = 0
        while task.wait() do
            hue = (hue + 0.005) % 1
            uiElement.UIStroke.Color = Color3.fromHSV(hue, 1, 1)
        end
    end)
end

-- Tạo UI KeySystem
if KeyConfig.Enable then
    local player = game.Players.LocalPlayer
    local gui = Instance.new("ScreenGui")
    gui.Parent = player.PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 320, 0, 160)
    frame.Position = UDim2.new(0.5, -160, 0.4, 0)
    frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    frame.Parent = gui
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

    -- Viền đổi màu
    local stroke = Instance.new("UIStroke", frame)
    stroke.Thickness = 2
    RainbowEffect(frame)

    local title = Instance.new("TextLabel")
    title.Text = KeyConfig.Title
    title.Size = UDim2.new(1, 0, 0, 40)
    title.BackgroundTransparency = 1
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 18
    title.Font = Enum.Font.GothamBold
    title.Parent = frame

    local input = Instance.new("TextBox")
    input.Size = UDim2.new(0.9, 0, 0, 36)
    input.Position = UDim2.new(0.05, 0, 0.4, 0)
    input.PlaceholderText = "Nhập key vào đây..."
    input.Text = ""
    input.TextSize = 16
    input.Font = Enum.Font.Gotham
    input.TextColor3 = Color3.new(1, 1, 1)
    input.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    Instance.new("UICorner", input).CornerRadius = UDim.new(0, 6)
    local stroke2 = Instance.new("UIStroke", input)
    stroke2.Thickness = 1.5
    RainbowEffect(input)
    input.Parent = frame

    -- Nút xác nhận (trái)
    local confirmBtn = Instance.new("TextButton")
    confirmBtn.Size = UDim2.new(0.4, -5, 0, 32)
    confirmBtn.Position = UDim2.new(0.05, 0, 0.75, 0)
    confirmBtn.Text = "Xác nhận"
    confirmBtn.Font = Enum.Font.GothamBold
    confirmBtn.TextSize = 16
    confirmBtn.TextColor3 = Color3.new(1, 1, 1)
    confirmBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    Instance.new("UICorner", confirmBtn).CornerRadius = UDim.new(0, 6)
    RainbowEffect(confirmBtn)
    confirmBtn.Parent = frame

    -- Nút Get Key (phải)
    local getKeyBtn = Instance.new("TextButton")
    getKeyBtn.Size = UDim2.new(0.4, -5, 0, 32)
    getKeyBtn.Position = UDim2.new(0.55, 0, 0.75, 0)
    getKeyBtn.Text = "Get Key"
    getKeyBtn.Font = Enum.Font.GothamBold
    getKeyBtn.TextSize = 16
    getKeyBtn.TextColor3 = Color3.new(1, 1, 1)
    getKeyBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    Instance.new("UICorner", getKeyBtn).CornerRadius = UDim.new(0, 6)
    RainbowEffect(getKeyBtn)
    getKeyBtn.Parent = frame

    -- Sự kiện
    confirmBtn.MouseButton1Click:Connect(function()
        local entered = input.Text
        local correct = false
        for _, k in ipairs(KeyConfig.Keys) do
            if entered == k then
                correct = true
                break
            end
        end
        if correct then
            frame:Destroy()
            game.StarterGui:SetCore("SendNotification", {
                Title = "Thành công",
                Text = KeyConfig.Notifications.Correct,
                Duration = 3
            })
            -- Gọi code chính ở đây
        else
            game.StarterGui:SetCore("SendNotification", {
                Title = "Lỗi",
                Text = KeyConfig.Notifications.Incorrect,
                Duration = 3
            })
        end
    end)

    getKeyBtn.MouseButton1Click:Connect(function()
        setclipboard(KeyConfig.KeyLink)
        game.StarterGui:SetCore("SendNotification", {
            Title = "Thông báo",
            Text = KeyConfig.Notifications.CopyKeyLink,
            Duration = 3
        })
    end)
end
